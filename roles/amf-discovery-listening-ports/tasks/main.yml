---
- name: "Capture Netstat output"
  shell: 'netstat -tulpn | awk "{if (NR>2) {print}}"'
  register: "netstat"
  changed_when: False

- name: "Process netstat output"
  listener:
    netstat: "{{ netstat.stdout_lines | to_json }}"

# listener module returns ansible_facts['listeners'] json
